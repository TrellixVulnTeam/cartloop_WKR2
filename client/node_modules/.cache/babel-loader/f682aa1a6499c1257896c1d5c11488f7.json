{"ast":null,"code":"var _jsxFileName = \"/Users/haleliamiad/Desktop/interviews/cartloop-chat/frontend/client/src/context/ChatContext.js\",\n    _s = $RefreshSig$();\n\nimport { createContext, useState, useEffect, useRef } from 'react';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ChatContext = /*#__PURE__*/createContext();\nexport const ChatProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [id, setId] = useState();\n  const [messages, setMessages] = useState([]);\n  const [isInvalidMessage, setIsInvalidMessage] = useState(false);\n  const [message, setMessage] = useState('');\n  const socketRef = useRef();\n  const messageData = {\n    body: message,\n    id,\n    name: 'Cameron Williamson'\n  }; // Listeners\n\n  useEffect(() => {\n    const ENV_URL = process.env.NODE_ENV === 'development' ? `${window.location.hostname}:3030` : '/';\n    socketRef.current = io.connect(ENV_URL);\n    socketRef.current.on('id', userId => {\n      setId(userId);\n    });\n    socketRef.current.on(\"message from server\", message => {\n      receivedMessage(message);\n    });\n    socketRef.current.on('message', message => {\n      receivedMessage(message);\n    });\n  }, []); // Delete history when screen is full\n\n  useEffect(() => {\n    messages.length > 10 ? setMessages([]) : null;\n  }, [messages]); // Validate against unallowed characters\n\n  const validateMessage = () => {\n    const regex = new RegExp(/[!@#$%^&*()\"{}|<>]/g);\n    const isUnallowedChars = regex.test(message);\n    isUnallowedChars ? createToast() : sendMessage();\n  }; // Emit event to server sockets\n\n\n  const sendMessage = () => {\n    setMessage('');\n    socketRef.current.emit('send message', messageData);\n    socketRef.current.emit('debounce', null);\n  }; // Notify user for invalid message\n\n\n  const createToast = () => {\n    setIsInvalidMessage(true);\n    setTimeout(() => {\n      setIsInvalidMessage(false);\n    }, 2000);\n  }; // Check message when pressing Enter\n\n\n  const sendByKey = e => {\n    e.preventDefault();\n    validateMessage();\n  }; // Check message when pressing on 'Resolve' button\n\n\n  const sendByButton = () => {\n    if (!message) return;\n    validateMessage(message);\n  }; // Set macro as message (when clicking on macro)\n\n\n  const setMacroAsMessage = macro => {\n    setMessage(macro);\n  }; // Bind message and input\n\n\n  const handleChange = e => {\n    setMessage(e.target.value);\n  }; // Add new message to messages array\n\n\n  const receivedMessage = message => {\n    setMessages(oldMessages => [...oldMessages, message]);\n  };\n\n  return /*#__PURE__*/_jsxDEV(ChatContext.Provider, {\n    value: {\n      receivedMessage,\n      handleChange,\n      sendByKey,\n      messages,\n      message,\n      id,\n      sendByButton,\n      setMacroAsMessage,\n      isInvalidMessage\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ChatProvider, \"E72pksZF+r6rNLyqilIPaEKSVBo=\");\n\n_c = ChatProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatProvider\");","map":{"version":3,"sources":["/Users/haleliamiad/Desktop/interviews/cartloop-chat/frontend/client/src/context/ChatContext.js"],"names":["createContext","useState","useEffect","useRef","io","ChatContext","ChatProvider","children","id","setId","messages","setMessages","isInvalidMessage","setIsInvalidMessage","message","setMessage","socketRef","messageData","body","name","ENV_URL","process","env","NODE_ENV","window","location","hostname","current","connect","on","userId","receivedMessage","length","validateMessage","regex","RegExp","isUnallowedChars","test","createToast","sendMessage","emit","setTimeout","sendByKey","e","preventDefault","sendByButton","setMacroAsMessage","macro","handleChange","target","value","oldMessages"],"mappings":"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","sourcesContent":["import { createContext, useState, useEffect, useRef } from 'react'\nimport io from 'socket.io-client';\nexport const ChatContext = createContext()\n\nexport const ChatProvider = ({ children }) => {\n    const [id, setId] = useState();\n    const [messages, setMessages] = useState([]);\n    const [isInvalidMessage, setIsInvalidMessage] = useState(false)\n    const [message, setMessage] = useState('');\n    const socketRef = useRef();\n    const messageData = {\n        body: message,\n        id,\n        name: 'Cameron Williamson',\n    };\n\n    // Listeners\n    useEffect(() => {\n        const ENV_URL = process.env.NODE_ENV === 'development' ? `${window.location.hostname}:3030` : '/'\n        socketRef.current = io.connect(ENV_URL);\n        socketRef.current.on('id', (userId) => {\n            setId(userId);\n        });\n        socketRef.current.on(\"message from server\", message => {\n            receivedMessage(message);\n        })\n        socketRef.current.on('message', (message) => {\n            receivedMessage(message);\n        });\n    }, []);\n\n    // Delete history when screen is full\n    useEffect(() => {\n        messages.length > 10 ? setMessages([]) : null\n    }, [messages])\n\n    // Validate against unallowed characters\n    const validateMessage = () => {\n        const regex = new RegExp(/[!@#$%^&*()\"{}|<>]/g);\n        const isUnallowedChars = regex.test(message)\n        isUnallowedChars ? createToast() : sendMessage()\n    }\n\n    // Emit event to server sockets\n    const sendMessage = () => {\n        setMessage('');\n        socketRef.current.emit('send message', messageData);\n        socketRef.current.emit('debounce', null);\n    }\n\n    // Notify user for invalid message\n    const createToast = () => {\n        setIsInvalidMessage(true)\n        setTimeout(() => {\n            setIsInvalidMessage(false)\n        }, 2000);\n    }\n\n    // Check message when pressing Enter\n    const sendByKey = (e) => {\n        e.preventDefault();\n        validateMessage()\n    }\n\n    // Check message when pressing on 'Resolve' button\n    const sendByButton = () => {\n        if (!message) return\n        validateMessage(message)\n    }\n\n    // Set macro as message (when clicking on macro)\n    const setMacroAsMessage = (macro) => {\n        setMessage(macro)\n    }\n\n    // Bind message and input\n    const handleChange = (e) => {\n        setMessage(e.target.value);\n    }\n\n    // Add new message to messages array\n    const receivedMessage = (message) => {\n        setMessages((oldMessages) => [...oldMessages, message]);\n    }\n\n    return (\n        <ChatContext.Provider\n            value={{\n                receivedMessage, handleChange, sendByKey, messages, message, id, sendByButton, setMacroAsMessage, isInvalidMessage\n            }}>\n            {children}\n        </ChatContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}